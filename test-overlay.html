<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Overlay X</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="assets/test-overlay.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

    <script>
      const CONFIG = {
        sheetId: '1IfaRkxsSQSrc9FloVuEY5paGmeEuTOGvru5TJeR6Hvg', // Google Sheet ID here
        sheetTab: 'Sheet1', // perhaps tab name?
      };
    </script>
  </head>
  <body>
    <div id="thing"></div>

    <script>
      function render(data) {
        const container = document.getElementById('thing');
        if (!data || data.length === 0) {
          container.innerHTML = '<p>No data.</p>';
          return;
        }

        let html = '<table><thead><tr>';
        const headers = Object.keys(data[0]);
        headers.forEach((h) => (html += `<th>${h}</th>`));
        html += '</tr></thead><tbody>';

        data.forEach((row) => {
          html += '<tr>';
          headers.forEach((h) => (html += `<td>${row[h] || ''}</td>`));
          html += '</tr>';
        });
        html += '</tbody></table>';

        container.innerHTML = html;
      }

      function fetchData() {
        // adjust "gid=0" as needed for different tabs.
        const csvUrl = `https://docs.google.com/spreadsheets/d/${CONFIG.sheetId}/export?format=csv&gid=0`;

        fetch(csvUrl)
          .then((res) => {
            if (!res.ok) throw new Error(`HTTP ${res.status}`);
            return res.text();
          })
          .then((txt) => {
            const { data } = Papa.parse(txt, { header: true, skipEmptyLines: true });
            render(data);
          })
          .catch((err) => {
            console.error('Fetch/Parse error:', err);
            document.getElementById('thing').innerHTML = '<p>Error loading data.</p>';
          });
      }

      window.addEventListener('DOMContentLoaded', () => {
        fetchData();
        setInterval(fetchData, 10 * 1000);
      });
    </script>
  </body>
</html>
